{% load cms_tags sekizai_tags static i18n %}
{% include "djangocms_lightbox2/includes/assets.html" %}

{% addtoblock "css" %}
  <link rel="stylesheet" href="{% static 'djangocms_lightbox2/carousel/carousel.css' %}">
{% endaddtoblock %}

<div class="dclb2-carousel" id="lb-carousel-{{ instance.pk }}">
  {% if items %}
    <div class="dclb2-carousel-main"
         role="region"
         aria-label="{% trans 'Carousel' %}"
         style="--dclb2-main-bg: {{ carousel_background_color|default:'#F8F8F8' }}; --dclb2-main-aspect: {{ carousel_aspect_ratio_css|default:'4 / 3' }}; --dclb2-object-fit: {{ carousel_object_fit|default:'cover' }};">
      {% for item in items %}
        <div class="dclb2-slide{% if forloop.first %} is-active{% endif %}" data-index="{{ forloop.counter0 }}">
          <a class="dclb2-item" href="{{ item.href }}" data-lightbox="{{ group_name }}"{% if item.caption %} data-title="{{ item.caption }}"{% endif %}>
            <img src="{{ item.href }}" alt="{{ item.alt }}">
          </a>
          {% if instance.show_fullscreen_button or instance.show_download_button %}
            <div class="dclb2-controls">
              {% if instance.show_fullscreen_button %}
                <button class="dclb2-btn dclb2-fullscreen" type="button" aria-label="{% trans 'Open fullscreen' %}"></button>
              {% endif %}
              {% if instance.show_download_button %}
                <a class="dclb2-btn dclb2-download" href="{{ item.href }}" download aria-label="{% trans 'Download image' %}"></a>
              {% endif %}
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>
    <div class="dclb2-carousel-thumbs" aria-label="{% trans 'Thumbnails' %}">
      <button class="dclb2-btn dclb2-thumbs-prev" type="button" aria-label="{% trans 'Previous' %}"></button>
      <div class="dclb2-thumbs-strip" role="tablist">
        {% for item in items %}
          <button class="dclb2-thumb{% if forloop.first %} active{% endif %}"
                  type="button"
                  data-index="{{ forloop.counter0 }}"
                  role="tab"
                  aria-selected="{% if forloop.first %}true{% else %}false{% endif %}"
                  aria-label="{{ item.alt|default:item.caption }}"
                  style="background-image:url('{{ item.thumb }}');">
          </button>
        {% endfor %}
      </div>
      <button class="dclb2-btn dclb2-thumbs-next" type="button" aria-label="{% trans 'Next' %}"></button>
    </div>
  {% else %}
    <!-- No items. Add 'Lightbox2 Image' child plugins. -->
  {% endif %}
  <noscript>{% trans 'Enable JavaScript to use Lightbox2.' %}</noscript>
</div>

{% addtoblock "js" %}
  <script src="{% static 'djangocms_lightbox2/carousel/carousel.js' %}"></script>
{% endaddtoblock %}
